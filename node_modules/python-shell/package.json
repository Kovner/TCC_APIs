{
  "name": "python-shell",
  "version": "0.0.3",
  "description": "Run Python scripts from Node.js with simple (but efficient) inter-process communication through stdio",
  "keywords": [
    "python"
  ],
  "scripts": {
    "test": "mocha -R spec"
  },
  "dependencies": {},
  "devDependencies": {
    "should": "^3.1.3",
    "mocha": "^1.17.1"
  },
  "repository": {
    "type": "git",
    "url": "http://github.com/extrabacon/python-shell"
  },
  "homepage": "http://github.com/extrabacon/python-shell",
  "bugs": {
    "url": "http://github.com/extrabacon/python-shell/issues"
  },
  "author": {
    "name": "Nicolas Mercier",
    "email": "nicolas@extrabacon.net"
  },
  "engines": {
    "node": ">=0.10"
  },
  "readme": "# python-shell\n\nA simple way to run Python scripts from Node.js with basic but efficient inter-process communication and better error handling.\n\n## Features\n\n+ Reliably spawn Python scripts in a child process\n+ Text, JSON and binary modes\n+ Simple and efficient data transfers through stdin and stdout streams\n+ Extended stack traces when an error is thrown\n\n## Installation\n\n```bash\nnpm install python-shell\n```\n\nTo run the tests:\n```bash\nnpm test\n```\n\n## Documentation\n\n### Running a Python script:\n\n```js\nvar PythonShell = require('python-shell');\n\nPythonShell.run('my_script.py', function (err) {\n  if (err) throw err;\n  console.log('finished');\n});\n```\n\nIf the script writes to stderr or exits with a non-zero code, an error will be thrown.\n\n### Running a Python script with arguments and options:\n\n```js\nvar PythonShell = require('python-shell');\n\nvar options = {\n  mode: 'text',\n  pythonPath: 'path/to/python',\n  pythonOptions: ['-u'],\n  scriptPath: 'path/to/my/scripts',\n  args: ['value1', 'value2', 'value3']\n};\n\nPythonShell.run('my_script.py', options, function (err, results) {\n  if (err) throw err;\n  // results is an array consisting of messages collected during execution\n  console.log('results: %j', results);\n});\n```\n\n### Exchanging data between Node and Python:\n\n```js\nvar PythonShell = require('python-shell');\nvar pyshell = new PythonShell('my_script.py');\n\n// sends a message to the Python script via stdin\npyshell.send('hello');\n\npyshell.on('message', function (message) {\n  // received a message sent from the Python script (a simple \"print\" statement)\n  console.log(message);\n});\n\n// end the input stream and allow the process to exit\npyshell.end(function (err) {\n  if (err) throw err;\n  console.log('finished');\n});\n```\n\nUse `.send(message)` to send a message to the Python script. Attach the `message` event to listen to messages emitted from the Python script.\n\nFor more details and examples including Python source code, take a look at the tests.\n\n### Error Handling and extended stack traces\n\nAn error will be thrown if the process exits with a non-zero exit code or if data has been written to stderr. Additionally, if \"stderr\" contains a formatted Python traceback, the error is augmented with Python exception details including a concatenated stack trace.\n\nSample error with traceback (from test/python/error.py):\n```\nTraceback (most recent call last):\n  File \"test/python/error.py\", line 6, in <module>\n    divide_by_zero()\n  File \"test/python/error.py\", line 4, in divide_by_zero\n    print 1/0\nZeroDivisionError: integer division or modulo by zero\n```\nwould result into the following error:\n```js\n{ [Error: ZeroDivisionError: integer division or modulo by zero]\n  traceback: 'Traceback (most recent call last):\\n  File \"test/python/error.py\", line 6, in <module>\\n    divide_by_zero()\\n  File \"test/python/error.py\", line 4, in divide_by_zero\\n    print 1/0\\nZeroDivisionError: integer division or modulo by zero\\n',\n  executable: 'python',\n  options: null,\n  script: 'test/python/error.py',\n  args: null,\n  exitCode: 1 }\n```\nand `err.stack` would look like this:\n```\nError: ZeroDivisionError: integer division or modulo by zero\n    at PythonShell.parseError (python-shell/index.js:131:17)\n    at ChildProcess.<anonymous> (python-shell/index.js:67:28)\n    at ChildProcess.EventEmitter.emit (events.js:98:17)\n    at Process.ChildProcess._handle.onexit (child_process.js:797:12)\n    ----- Python Traceback -----\n    File \"test/python/error.py\", line 6, in <module>\n      divide_by_zero()\n    File \"test/python/error.py\", line 4, in divide_by_zero\n      print 1/0\n```\n\n## API Reference\n\n#### `PythonShell(script, options)` constructor\n\nCreates an instance of `PythonShell` and starts the Python process\n\n* `script`: the path of the script to execute\n* `options`: the execution options, consisting of:\n  * `mode`: Configures how data is exchanged when data flows through stdin and stdout. The possible values are:\n    * `text`: each line of data (ending with \"\\n\") is emitted as a message (default)\n    * `json`: each line of data (ending with \"\\n\") is parsed as JSON and emitted as a message\n    * `binary`: data is streamed as-is through `stdout` and `stdin`\n  * `pythonPath`: The path where to locate the \"python\" executable. Default: \"python\"\n  * `pythonOptions`: Array of option switches to pass to \"python\"\n  * `scriptPath`: The default path where to look for scripts. Default: \"./python\"\n  * `args`: Array of arguments to pass to the script\n\nOther options are forwarded to `child_process.spawn`.\n\nPythonShell instances have the following properties:\n* `script`: the path of the script to execute\n* `command`: the full command arguments passed to the Python executable\n* `stdin`: the Python stdin stream, used to send data to the child process\n* `stdout`: the Python stdout stream, used for receiving data from the child process\n* `stderr`: the Python stderr stream, used for communicating errors\n* `childProcess`: the process instance created via `child_process.spawn`\n* `terminated`: boolean indicating whether the process has exited\n* `exitCode`: the process exit code, available after the process has ended\n\nExample:\n```js\n// create a new instance\nvar shell = new PythonShell('script.py', options);\n```\n\n#### `#defaultOptions`\n\nConfigures default options for all new instances of PythonShell.\n\nExample:\n```js\n// setup a default \"scriptPath\"\nPythonShell.defaultOptions = { scriptPath: '../scripts' };\n```\n\n#### `#run(script, options, callback)`\n\nRuns the Python script and invokes `callback` with the results. The callback contains the execution error (if any) as well as an array of messages emitted from the Python script.\n\nThis method is also returning the `PythonShell` instance.\n\nExample:\n```js\n// run a simple script\nPythonShell.run('script.py', function (err, results) {\n  // script finished\n});\n```\n\n#### `.send(message)`\n\nSends a message to the Python script via stdin. The data is formatted according to the selected mode (text or JSON). This method can be overridden in order to format the data in some other way.\n\nThis method should not be used in binary mode.\n\nExample:\n```js\n// send a message in text mode\nvar shell = new PythonShell('script.py', { mode: 'text '});\nshell.send('hello world!');\n\n// send a message in JSON mode\nvar shell = new PythonShell('script.py', { mode: 'json '});\nshell.send({ command: \"do_stuff\", args: [1, 2, 3] });\n```\n\n#### `.receive(data)`\n\nParses incoming data from the Python script written via stdout and emits `message` events. The data is parsed as JSON if mode has been set to \"json\". This method is called automatically as data is being received from stdout and can be overridden to parse the data differently.\n\n#### `.end(callback)`\n\nCloses the stdin stream, allowing the Python script to finish and exit. The optional callback is invoked when the process is terminated.\n\n#### event: `message`\n\nFires when a chunk of data is parsed from the stdout stream via the `receive` method. This event is not emitted in binary mode.\n\nExample:\n```js\n// receive a message in text mode\nvar shell = new PythonShell('script.py', { mode: 'text '});\nshell.on('message', function (message) {\n  // handle message (a line of text from stdout)\n});\n\n// receive a message in JSON mode\nvar shell = new PythonShell('script.py', { mode: 'json '});\nshell.on('message', function (message) {\n  // handle message (a line of text from stdout, parsed as JSON)\n});\n```\n\n#### event: `close`\n\nFires when the process has been terminated, with an error or not.\n\n#### event: `error`\n\nFires when the process terminates with a non-zero exit code, or if data is written to the stderr stream.\n\n## License\n\nThe MIT License (MIT)\n\nCopyright (c) 2014 Nicolas Mercier\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n",
  "readmeFilename": "README.md",
  "_id": "python-shell@0.0.3",
  "dist": {
    "shasum": "72375971175fa96d1ee90254c2d37c3f2f945c26"
  },
  "_from": "python-shell@0.0.x",
  "_resolved": "https://registry.npmjs.org/python-shell/-/python-shell-0.0.3.tgz"
}
